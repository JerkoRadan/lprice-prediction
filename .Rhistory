mutate(cpu_details,cpu_clean= gsub("\\s*(\\d[.]\\d*)\\s*(GHz|ghz|Ghz|Ghz|gHz).*","",clean_test1$cpu_details))
cpu_df<-cpu_df %>%
mutate(cpu_model,cpu_clean= gsub("\\s*([@]).*|\\s*(APU).*","",cpu_df$cpu_model))
clean_test2 <- clean_test1 %>%
left_join(cpu_df,by="cpu_clean")
clean_test2$cpu_model <- as.character(clean_test2$cpu_model)
clean_test2$cpu_benchmark_score[is.na(clean_test2$cpu_benchmark_score)] <- 500
clean_test2$cpu_model[is.na(clean_test2$cpu_model)] <- "other"
#--------------GPU Scores for test data -----------------------------------------------
clean_test3 <- mutate(clean_test2, gpu = ifelse(discrete_gpu == 0, 0,as.character(gpu)))
clean_test3<-clean_test3 %>%
mutate(gpu,gpu_model= gsub("^(\\S+\\s+\\n?){1}","",clean_test3$gpu))
gpu_df[,1] <- gsub(" with", "", gpu_df$gpu_model)
gpu_df[,1] <- gsub(" Design", "", gpu_df$gpu_model)
clean_test3$gpu_model <- gsub("GeFoce", "GeForce", clean_test3$gpu_model)
clean_test3$gpu_model <- gsub("GTX1070", "GTX 1070", clean_test3$gpu_model)
clean_test3 <- clean_test3 %>%
left_join(gpu_df,by="gpu_model")
clean_test3$gpu_benchmark_score[clean_test3$gpu_model == 0] <- 0
geforce_df <- filter(clean_test3, grepl('GeForce',clean_test3$gpu))
geforce_mean_score <- mean(geforce_df$gpu_benchmark_score, na.rm =TRUE)
clean_test3[is.na(clean_test3$gpu_benchmark_score) & grepl("GeForce",clean_test3$gpu_model),"gpu_benchmark_score"] <- geforce_mean_score
gpu_null <- clean_test3 %>%
select(gpu_model,gpu_benchmark_score) %>%
filter(is.na(clean_test3$gpu_benchmark_score))
clean_test3[is.na(clean_test3$gpu_benchmark_score),"gpu_benchmark_score"] <- mean(clean_test3$gpu_benchmark_score,na.rm=TRUE)
clean_test3$base_name <- tolower(clean_test3$base_name)
clean_test3$name <- tolower(clean_test3$name)
base_nam_test <- clean_test3 %>%
mutate(base_name_clean= base_name) %>%
mutate(base_name_clean= ifelse(grepl("asus rog gl702vs",base_name_clean),"ASUS ROG Strix GL702VS",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus 14 eeebook",base_name_clean),"asus eeebook 14",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus zenbook 3 deluxe ux490ua",base_name_clean),"asus zenbook 3",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell i3558-9136blk",base_name_clean),"Dell Inspiron 15.6 Touch-Screen Laptop Intel Core",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell g3",base_name_clean),"Dell g",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell g5",base_name_clean),"Dell g",base_name_clean)) %>%
mutate(base_name_clean= gsub("^.*dell xps\\S+.*","Dell xps",base_name_clean)) %>%
mutate(base_name_clean= gsub("delll","dell",base_name_clean)) %>%
mutate(base_name_clean= gsub("apple macbook pro [(]2019[)]","apple macbook pro 2019",base_name_clean)) %>%
mutate(base_name_clean= gsub("apple macbook pro 2015","apple macbook pro 2014",base_name_clean)) %>%
mutate(base_name_clean= gsub("apple macbook pro 2011","apple macbook pro 2012",base_name_clean)) %>%
mutate(base_name_clean= gsub("apple macbook 2015","apple macbook 2017",base_name_clean)) %>%
mutate(base_name_clean= gsub("microsoft surface go","microsoft surface 3",base_name_clean)) %>%
mutate(base_name_clean= gsub("asus rog gl\\d+","asus rog strix ",base_name_clean)) %>%
mutate(base_name_clean= gsub("asus zenbook 3 ","asus zenbook ",base_name_clean)) %>%
mutate(base_name_clean= gsub("dell precision","dell latitude",base_name_clean)) %>%
mutate(base_name_clean= gsub("asus vivobook pro","asus vivobook",base_name_clean)) %>%
mutate(base_name_clean= gsub("razer blade$","razer blade pro",base_name_clean)) %>%
mutate(base_name_clean= gsub("lenovo v330","lenovo chromebook",base_name_clean)) %>%
mutate(base_name_clean= gsub("lenovo 300e","lenovo chromebook",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell inspiron chromebook",base_name_clean),"dell chromebook",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus transformer mini",base_name_clean),"asus transformer book mini",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus l402sa",base_name_clean),"  ASUS Vivobook L402SA",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("alienware area-51m",base_name_clean),"alienware 17 r5",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("samsung chromebook xe303c12",base_name_clean),"samsung chromebook",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("acer cb3-532",base_name_clean),"acer chromebook cb3-532",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus c302ca-dhm4",base_name_clean),"asus chromebook c302ca-dhm4",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("acer cb3-531-c4a5",base_name_clean),"acer chromebook cb3-531-c4a5",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("acer r11",base_name_clean),"acer chromebook r11",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus c300sa",base_name_clean),"asus chromebook c300sa",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("samsung notebook flash",base_name_clean),"samsung notebook",base_name_clean))
base_nam_test <- base_nam_test %>%
mutate(base_name_clean= gsub("\\s*([(]).*|\\s*([-]).*","",base_nam_test$base_name_clean))
base_nam_test <- base_nam_test %>%
mutate(base_name_clean2= ifelse(grepl("hp",base_name) & grepl("x360",base_name),gsub("x360","flip",base_nam_test$base_name_clean),base_name_clean)) %>%
mutate(base_name_clean = base_name_clean2)
base_nam_test$base_name_clean <- tolower(base_nam_test$base_name_clean)
base_nam_test <- base_nam_test %>%
mutate(base_name_clean=ifelse(grepl("acer",base_name),str_extract(base_nam_test$base_name_clean,"^(?=.*\\bacer\\b)(?:\\S+\\s){2}|^(?=.*\\bacer\\b)(?:\\S+){1}"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("alienware",base_name),str_extract(base_nam_test$base_name_clean,"(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("alienware\\s\\D+\\d+",base_name_clean),str_extract(base_nam_test$base_name_clean,"\\S+\\s\\D+"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus",base_name),str_extract(base_nam_test$base_name_clean,"(\\S+\\s){2,3}|(\\S+\\s\\S+){1,2}"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus x5.*",base_name),"asus x5",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus fx.*",base_name),"asus fx",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus\\s[q]\\d+.*",base_name),"asus q",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("dell",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("google",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("hp",base_name_clean) & !grepl("flip",base_name_clean),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("hp",base_name_clean) & grepl("flip",base_name_clean),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){3}|^(\\S+\\s\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("hp\\s\\d+",base_name),"hp",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("huawei",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("lg",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("microsoft",base_name),str_extract(base_nam_test$base_name_clean,"^(\\w+\\s+){3}|^(\\S+\\s\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("msi",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s+\\D+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("prostar",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s+\\D+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("sager",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s+\\D+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("samsung",base_name),str_extract(base_nam_test$base_name_clean,"^(\\w+\\s+){3}|^(\\S+\\s\\S+\\s\\S+)|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("samsung\\s\\S+\\s\\d+",base_name),str_extract(base_nam_test$base_name_clean,"samsung\\s\\S+"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("razer",base_name),str_extract(base_nam_test$base_name_clean,"^(\\w+\\s+){3}|^(\\S+\\s\\S+\\s\\S+)|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("jumper",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("toshiba",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("lenovo",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("rca",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
select(brand,base_name,base_name_clean,name,touchscreen)
base_nam_test <- base_nam_test %>%
mutate(base_name_clean= gsub("flip","",base_name_clean))
base_nam_test$base_name_clean <- str_squish(base_nam_test$base_name_clean)
unique(base_nam_test$base_name_clean)
clean_test3$base_name_clean <- base_nam_test$base_name_clean
clean_test3$base_name_clean[!(clean_test3$base_name_clean %in% clean6$base_name_clean)]
clean_test3 <- clean_test3 %>%
mutate(x360 = ifelse(grepl("2-in-1",name)|grepl("x360",name)|grepl("transformer",name)|grepl("convertible",name)|grepl("flip",name)|
grepl("2-in-1",base_name)|grepl("x360",base_name)|grepl("transformer",base_name)|grepl("convertible",base_name)|grepl("flip",base_name)
,1,0))
clean_test3 <- clean_test3 %>%
mutate(weight_clean= ifelse(weight<3,"Up to 3 Pounds",weight)) %>%
mutate(weight_clean= ifelse(weight>=3 & weight<4,"3 to 3.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=4 & weight<5,"4 to 4.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=5 & weight<6,"5 to 5.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=6 & weight<7,"6 to 6.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=7 & weight<8,"7 to 7.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=8 ,"8 Pounds & Above",weight_clean))
clean_test3$screen_size <- as.factor(clean_test3$screen_size)
clean_test3$os <-as.factor(clean_test3$os)
clean_test3$resolution <- as.factor(clean_test3$resolution)
clean_test3$weight_clean <- as.factor(clean_test3$weight_clean)
#---------Load Libraries ------------------------------------
library(plyr)
library(tidyverse)
library(naniar)
library(VIM)
library(DMwR)
library(caret)
library(PerformanceAnalytics)
#--------Load Data-------------------------------------------
train_df <- read.csv("https://raw.githubusercontent.com/behnouri/lprice-prediction/master/train.csv", na.strings = c("", "NA"))
test_df <- read.csv("https://raw.githubusercontent.com/behnouri/lprice-prediction/master/test.csv", na.strings=c("NA",""))
#--------Load CPU and GPU Data-----------------------------------------
gpu_df <- read.csv("https://raw.githubusercontent.com/behnouri/lprice-prediction/master/GPU_Benchmark.csv", na.strings = c("", "NA"))
cpu_df <- read.csv("https://raw.githubusercontent.com/behnouri/lprice-prediction/master/CPU_Benchmark.csv", na.strings = c("", "NA"))
colnames(cpu_df)[1] <- "cpu_model"
colnames(cpu_df)[2] <- "cpu_benchmark_score"
colnames(gpu_df)[1] <- "gpu_model"
colnames(gpu_df)[2] <- "gpu_benchmark_score"
new.cpu <- data.frame(cpu_model = c("Intel Pentium Gold 4415Y", "Intel Pentium Gold 4417U"),
cpu_benchmark_score = c(3800, 3900))
cpu_df <- rbind(cpu_df, new.cpu)
###############################Prepare Train Data#############################################
colnames(train_df)[12] <- "dkeyboard"
colnames(train_df)[1] <- "id"
##--------------------NA Values for TRAIN DATA------------------------------------
##--------------------Remove Rows with more than 4 nulls--------------------------
rown_four_nulls <- as.integer(rownames(train_df[rowSums(is.na(train_df[])) == 4,]))
clean2 <- train_df[-c(rown_four_nulls),]
gg_miss_var(clean2)
gg_miss_case(clean2)
##-------------------Use Knn for imputing null values-----------------------------
aggr(x = clean2[,8:20])
clean3_knn <- knnImputation(clean2)
aggr(x=clean3_knn)
##-----------------Screen Surface for TRAIN DATA----------------------------------------------------
clean3_knn$screen_surface <- tolower(clean3_knn$screen_surface)
##----------------Screen Resolution for TRAIN DATA--------------------------------------------
clean4 <- clean3_knn %>%
mutate(resolution = NA)
clean4 <- clean4 %>%
mutate(resolution= ifelse(pixels_x==1366 & pixels_y==768,"HD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1600 & pixels_y==900,"HD+",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1920 & pixels_y==1080,"FHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2304 & pixels_y==1440,"Retina",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2560 & pixels_y==1440,"QHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2560 & pixels_y==1600,"Retina",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2880 & pixels_y==1800,"Retina",resolution)) %>%
mutate(resolution= ifelse(pixels_x==3000 & pixels_y==2000,"PixelSense",resolution)) %>%
mutate(resolution= ifelse(pixels_x==3200 & pixels_y==1800,"QHD+",resolution)) %>%
mutate(resolution= ifelse(pixels_x==3840 & pixels_y==2160,"UHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1920 & pixels_y==1280,"FHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2160 & pixels_y==1440,"FHD+",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1280 & pixels_y==800,"HD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1920 & pixels_y==1280,"FHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2400 & pixels_y==1600,"QHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2736 & pixels_y==1824,"UHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==3072 & pixels_y==1920,"Retina",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1920 & pixels_y==1200,"FHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2256 & pixels_y==1504,"PixelSense",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2736 & pixels_y==1824,"PixelSense",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1440 & pixels_y==900,"airhd",resolution)) %>%
mutate(resolution= ifelse(pixels_x==3240 & pixels_y==2160,"PixelSense",resolution))
##------------------Screen Size for TRAIN DATA---------------------------------------------------
clean4 <- clean4 %>%
mutate(screen_size= ifelse(screen_size>=10 & screen_size<=10.7,10,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=10.8 & screen_size<=11.7,11,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=11.8 & screen_size<=12.6,12,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=12.7 & screen_size<=13.6,13,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=13.7 & screen_size<=14.6,14,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=13.7 & screen_size<=14.6,14,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=14.7 & screen_size<=15.6,15,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=15.7 & screen_size<=16.6,16,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=16.7 & screen_size<=17.6,17,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=17.7 & screen_size<=18.6,18,screen_size))
##---------------------Display Type---------------------------------------------
clean4$name <- tolower(clean4$name)
clean4 <- clean4 %>%
mutate(display_type= "unkonwn") %>%
mutate(display_type= ifelse(grepl("lcd",name),"lcd",display_type)) %>%
mutate(display_type= ifelse(grepl("led",name),"led",display_type)) %>%
mutate(display_type= ifelse(grepl("oled",name),"oled",display_type)) %>%
mutate(display_type= ifelse(grepl("ips",name),"ips",display_type)) %>%
mutate(display_type= ifelse(brand=="Apple" & resolution=="Retina","ips",display_type)) %>%
mutate(display_type= ifelse(brand=="Apple" & (resolution=="HD"|resolution=="airhd"),"led",display_type)) %>%
mutate(display_type= ifelse(grepl("Microsoft Surface",base_name),"ips",display_type))
##---------------------CPU Scores-----------------------------------------------
clean4<-clean4 %>%
mutate(cpu_details,cpu_clean= gsub("\\s*(\\d[.]\\d*)\\s*(GHz|ghz|Ghz|Ghz|gHz).*","",clean4$cpu_details))
cpu_df<-cpu_df %>%
mutate(cpu_model,cpu_clean= gsub("\\s*([@]).*|\\s*(APU).*","",cpu_df$cpu_model))
clean5 <- clean4 %>%
left_join(cpu_df,by="cpu_clean")
clean5$cpu_model <- as.character(clean5$cpu_model)
clean5$cpu_benchmark_score[is.na(clean5$cpu_benchmark_score)] <- 500
clean5$cpu_benchmark_score[clean5$cpu_details=="Intel Pentium Gold 4415Y"] <- 3800
clean5$cpu_model[is.na(clean5$cpu_model)] <- "other"
###--------------GPU Scores for TRAIN DATA-----------------------------------------------
clean6 <- mutate(clean5, gpu = ifelse(discrete_gpu == 0, 0,as.character(gpu)))
clean6<-clean6 %>%
mutate(gpu,gpu_model= gsub("^(\\S+\\s+\\n?){1}","",clean6$gpu))
gpu_df[,1] <- gsub(" with", "", gpu_df$gpu_model)
gpu_df[,1] <- gsub(" Design", "", gpu_df$gpu_model)
clean6$gpu_model <- gsub("GeFoce", "GeForce", clean6$gpu_model)
clean6$gpu_model <- gsub("GTX1070", "GTX 1070", clean6$gpu_model)
clean6 <- clean6 %>%
left_join(gpu_df,by="gpu_model")
clean6$gpu_benchmark_score[clean6$gpu_model == 0] <- 0
geforce_df <- filter(clean6, grepl('GeForce',clean6$gpu))
geforce_mean_score <- mean(geforce_df$gpu_benchmark_score, na.rm =TRUE)
clean6[is.na(clean6$gpu_benchmark_score) & grepl("GeForce",clean6$gpu_model),"gpu_benchmark_score"] <- geforce_mean_score
gpu_null <- clean6 %>%
select(gpu_model,gpu_benchmark_score) %>%
filter(is.na(clean6$gpu_benchmark_score))
clean6[is.na(clean6$gpu_benchmark_score),"gpu_benchmark_score"] <- mean(clean6$gpu_benchmark_score,na.rm=TRUE)
##-------------------Base Name for TRAIN DATA--------------------------------------------------------
library(stringr)
clean6$base_name <- tolower(clean6$base_name)
clean6$name <- tolower(clean6$name)
base_nam <- clean6 %>%
mutate(base_name_clean= base_name) %>%
mutate(base_name_clean= ifelse(grepl("asus rog gl702vs",base_name_clean),"ASUS ROG Strix GL702VS",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus 14 eeebook",base_name_clean),"asus eeebook 14",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus zenbook 3 deluxe ux490ua",base_name_clean),"asus zenbook 3",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell i3558-9136blk",base_name_clean),"Dell Inspiron 15.6 Touch-Screen Laptop Intel Core",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell g3",base_name_clean),"Dell g",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell g5",base_name_clean),"Dell g",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell g5",base_name_clean),"Dell g",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("acer cb3-532",base_name_clean),"acer chromebook cb3-532",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus c302ca-dhm4",base_name_clean),"asus chromebook c302ca-dhm4",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("acer cb3-531-c4a5",base_name_clean),"acer chromebook cb3-531-c4a5",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus c300sa",base_name_clean),"asus chromebook c300sa",base_name_clean)) %>%
mutate(base_name_clean= gsub("^.*dell xps\\S+.*","Dell xps",base_name_clean)) %>%
mutate(base_name_clean= gsub("lenovo 100e","lenovo",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell inspiron chromebook",base_name_clean),"dell chromebook",base_name_clean))
base_dd <- clean6 %>%
select(base_name)
base_nam <- base_nam %>%
mutate(base_name_clean= gsub("\\s*([(]).*|\\s*([-]).*","",base_nam$base_name_clean))
base_nam <- base_nam %>%
mutate(base_name_clean2= ifelse(grepl("hp",base_name) & grepl("x360",base_name),gsub("x360","flip",base_nam$base_name_clean),base_name_clean)) %>%
mutate(base_name_clean = base_name_clean2)
base_nam$base_name_clean <- tolower(base_nam$base_name_clean)
base_nam <- base_nam %>%
mutate(base_name_clean=ifelse(grepl("acer",base_name),str_extract(base_nam$base_name_clean,"^(?=.*\\bacer\\b)(?:\\S+\\s){2}|^(?=.*\\bacer\\b)(?:\\S+){1}"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("alienware",base_name),str_extract(base_nam$base_name_clean,"(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("alienware\\s\\D+\\d+",base_name),str_extract(base_nam$base_name_clean,"\\S+\\s\\D+"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus",base_name),str_extract(base_nam$base_name_clean,"(\\S+\\s){2,3}|(\\S+\\s\\S+){1,2}"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus x5.*",base_name),"asus x5",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus fx.*",base_name),"asus fx",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus\\s[q]\\d+.*",base_name),"asus q",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("dell",base_name),str_extract(base_nam$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("google",base_name),str_extract(base_nam$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("hp",base_name_clean) & !grepl("flip",base_name_clean),str_extract(base_nam$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("hp",base_name_clean) & grepl("flip",base_name_clean),str_extract(base_nam$base_name_clean,"^(\\S+\\s){3}|^(\\S+\\s\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("hp\\s\\d+",base_name),"hp",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("huawei",base_name),str_extract(base_nam$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("lg",base_name),str_extract(base_nam$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("microsoft",base_name),str_extract(base_nam$base_name_clean,"^(\\w+\\s+){3}|^(\\S+\\s\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("msi",base_name),str_extract(base_nam$base_name_clean,"^(\\S+\\s+\\D+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("prostar",base_name),str_extract(base_nam$base_name_clean,"^(\\S+\\s+\\D+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("sager",base_name),str_extract(base_nam$base_name_clean,"^(\\S+\\s+\\D+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("samsung",base_name),str_extract(base_nam$base_name_clean,"^(\\w+\\s+){3}|^(\\S+\\s\\S+\\s\\S+)|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("samsung\\s\\S+\\s\\d+",base_name),str_extract(base_nam$base_name_clean,"samsung\\s\\S+"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("razer",base_name),str_extract(base_nam$base_name_clean,"^(\\w+\\s+){3}|^(\\S+\\s\\S+\\s\\S+)|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("jumper",base_name),str_extract(base_nam$base_name_clean,"^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("toshiba",base_name),str_extract(base_nam$base_name_clean,"^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("lenovo",base_name),str_extract(base_nam$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("rca",base_name),str_extract(base_nam$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
select(brand,base_name,base_name_clean,max_price,name,touchscreen)
base_nam <- base_nam %>%
mutate(base_name_clean= gsub("flip","",base_name_clean))
base_nam$base_name_clean <- str_squish(base_nam$base_name_clean)
unique(base_nam$base_name_clean)
clean6$base_name_clean <- base_nam$base_name_clean
#--------- 2-in-1 laptops --------------------------------------------
clean6 <- clean6 %>%
mutate(x360 = ifelse(grepl("2-in-1",name)|grepl("x360",name)|grepl("transformer",name)|grepl("convertible",name)|grepl("flip",name)|
grepl("2-in-1",base_name)|grepl("x360",base_name)|grepl("transformer",base_name)|grepl("convertible",base_name)|grepl("flip",base_name)
,1,0))
##------------------weight for Train Data---------------------------------------------------
clean6 <- clean6 %>%
mutate(weight_clean= ifelse(weight<3,"Up to 3 Pounds",weight)) %>%
mutate(weight_clean= ifelse(weight>=3 & weight<4,"3 to 3.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=4 & weight<5,"4 to 4.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=5 & weight<6,"5 to 5.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=6 & weight<7,"6 to 6.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=7 & weight<8,"7 to 7.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=8 ,"8 Pounds & Above",weight_clean))
#--------- Factorising Train Data-----------------------------------------------
clean6$screen_size <- as.factor(clean6$screen_size)
clean6$os <-as.factor(clean6$os)
clean6$resolution <- as.factor(clean6$resolution)
clean6$weight_clean <- as.factor(clean6$weight_clean)
#--------- Price variation and Percentage change -------------------
# Price variation
clean6 <- clean6 %>%
mutate(price_variation = max_price - min_price)
# Price percentage variation based on min_price
clean6 <- clean6 %>%
mutate(price_percentage_variation_min = (max_price - min_price)/min_price)
# Price percentage variation based on max_price
clean6 <- clean6 %>%
mutate(price_percentage_variation_max = (max_price - min_price)/max_price)
# Average price
clean6 <- clean6 %>%
mutate(ave_price = (max_price + min_price)/2)
hist(clean6$price_variation)
table(clean6$price_variation)
hist(clean6$price_percentage_variation_min)
table(clean6$price_percentage_variation_min)
clean6[clean6$id == 8789 |clean6$id == 20741,]
#-------Split Train Data to train/test subsets (80/20 percent) --------- // Currently not use because K-Folds creates a validation set
#require(caTools)
#set.seed(741)
#sample = sample.split(clean3_knn$id,SplitRatio = 0.8)
#training_subset =subset(clean3_knn,sample ==TRUE)
#test_subset = subset(clean3_knn,sample ==FALSE)
###################################Prepare Test Data###########################################################
colnames(test_df)[12] <- "dkeyboard"
colnames(test_df)[1] <- "id"
glimpse(test_df)
sum(is.na(test_df))
aggr(x=test_df[,6:20])
clean_test <- test_df
##------------Knn imputation of tet data---------------------------------------
clean_test_knn <- knnImputation(clean_test)
aggr(x=clean_test_knn)
##----------------Screen Surface for Test Data------------------------
clean_test$screen_surface <- tolower(clean_test$screen_surface)
##----------------Screen Resolution for TEST DATA--------------------------------------------
#---outlier width and lenght----------------------
clean_test1<-clean_test
clean_test1[133,"pixels_x"] <- 1366
clean_test1[133,"pixels_y"] <- 768
clean_test1[203,"pixels_x"] <- 1366
clean_test1[203,"pixels_y"] <- 768
clean_test1 <- clean_test1 %>%
mutate(resolution = NA)
clean_test1 <- clean_test1 %>%
mutate(resolution= ifelse(pixels_x==1366 & pixels_y==768,"HD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1600 & pixels_y==900,"HD+",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1920 & pixels_y==1080,"FHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2304 & pixels_y==1440,"Retina",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2560 & pixels_y==1440,"QHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2560 & pixels_y==1600,"Retina",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2880 & pixels_y==1800,"Retina",resolution)) %>%
mutate(resolution= ifelse(pixels_x==3000 & pixels_y==2000,"PixelSense",resolution)) %>%
mutate(resolution= ifelse(pixels_x==3200 & pixels_y==1800,"QHD+",resolution)) %>%
mutate(resolution= ifelse(pixels_x==3840 & pixels_y==2160,"UHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1920 & pixels_y==1280,"FHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2160 & pixels_y==1440,"FHD+",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1280 & pixels_y==800,"HD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1920 & pixels_y==1280,"FHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2400 & pixels_y==1600,"QHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2736 & pixels_y==1824,"UHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==3072 & pixels_y==1920,"Retina",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1920 & pixels_y==1200,"FHD",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2256 & pixels_y==1504,"PixelSense",resolution)) %>%
mutate(resolution= ifelse(pixels_x==2736 & pixels_y==1824,"PixelSense",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1440 & pixels_y==900,"airhd",resolution)) %>%
mutate(resolution= ifelse(pixels_x==3240 & pixels_y==2160,"PixelSense",resolution)) %>%
mutate(resolution= ifelse(pixels_x==1800 & pixels_y==1200,"PixelSense",resolution))
##------------------Screen Size for TEST DATA---------------------------------------------------
clean_test1 <- clean_test1 %>%
mutate(screen_size= ifelse(screen_size>=10 & screen_size<=10.7,10,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=10.8 & screen_size<=11.7,11,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=11.8 & screen_size<=12.6,12,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=12.7 & screen_size<=13.6,13,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=13.7 & screen_size<=14.6,14,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=13.7 & screen_size<=14.6,14,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=14.7 & screen_size<=15.6,15,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=15.7 & screen_size<=16.6,16,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=16.7 & screen_size<=17.6,17,screen_size)) %>%
mutate(screen_size= ifelse(screen_size>=17.7 & screen_size<=18.6,18,screen_size))
#--------------CPU Scores for test data -----------------------------------------
clean_test1 <-clean_test1 %>%
mutate(cpu_details,cpu_clean= gsub("\\s*(\\d[.]\\d*)\\s*(GHz|ghz|Ghz|Ghz|gHz).*","",clean_test1$cpu_details))
cpu_df<-cpu_df %>%
mutate(cpu_model,cpu_clean= gsub("\\s*([@]).*|\\s*(APU).*","",cpu_df$cpu_model))
clean_test2 <- clean_test1 %>%
left_join(cpu_df,by="cpu_clean")
clean_test2$cpu_model <- as.character(clean_test2$cpu_model)
clean_test2$cpu_benchmark_score[is.na(clean_test2$cpu_benchmark_score)] <- 500
clean_test2$cpu_model[is.na(clean_test2$cpu_model)] <- "other"
#--------------GPU Scores for test data -----------------------------------------------
clean_test3 <- mutate(clean_test2, gpu = ifelse(discrete_gpu == 0, 0,as.character(gpu)))
clean_test3<-clean_test3 %>%
mutate(gpu,gpu_model= gsub("^(\\S+\\s+\\n?){1}","",clean_test3$gpu))
gpu_df[,1] <- gsub(" with", "", gpu_df$gpu_model)
gpu_df[,1] <- gsub(" Design", "", gpu_df$gpu_model)
clean_test3$gpu_model <- gsub("GeFoce", "GeForce", clean_test3$gpu_model)
clean_test3$gpu_model <- gsub("GTX1070", "GTX 1070", clean_test3$gpu_model)
clean_test3 <- clean_test3 %>%
left_join(gpu_df,by="gpu_model")
clean_test3$gpu_benchmark_score[clean_test3$gpu_model == 0] <- 0
geforce_df <- filter(clean_test3, grepl('GeForce',clean_test3$gpu))
geforce_mean_score <- mean(geforce_df$gpu_benchmark_score, na.rm =TRUE)
clean_test3[is.na(clean_test3$gpu_benchmark_score) & grepl("GeForce",clean_test3$gpu_model),"gpu_benchmark_score"] <- geforce_mean_score
gpu_null <- clean_test3 %>%
select(gpu_model,gpu_benchmark_score) %>%
filter(is.na(clean_test3$gpu_benchmark_score))
clean_test3[is.na(clean_test3$gpu_benchmark_score),"gpu_benchmark_score"] <- mean(clean_test3$gpu_benchmark_score,na.rm=TRUE)
#--------- Base_name_for_test_data-------------------------------------------------
clean_test3$base_name <- tolower(clean_test3$base_name)
clean_test3$name <- tolower(clean_test3$name)
base_nam_test <- clean_test3 %>%
mutate(base_name_clean= base_name) %>%
mutate(base_name_clean= ifelse(grepl("asus rog gl702vs",base_name_clean),"ASUS ROG Strix GL702VS",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus 14 eeebook",base_name_clean),"asus eeebook 14",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus zenbook 3 deluxe ux490ua",base_name_clean),"asus zenbook 3",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell i3558-9136blk",base_name_clean),"Dell Inspiron 15.6 Touch-Screen Laptop Intel Core",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell g3",base_name_clean),"Dell g",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell g5",base_name_clean),"Dell g",base_name_clean)) %>%
mutate(base_name_clean= gsub("^.*dell xps\\S+.*","Dell xps",base_name_clean)) %>%
mutate(base_name_clean= gsub("delll","dell",base_name_clean)) %>%
mutate(base_name_clean= gsub("apple macbook pro [(]2019[)]","apple macbook pro 2019",base_name_clean)) %>%
mutate(base_name_clean= gsub("apple macbook pro 2015","apple macbook pro 2014",base_name_clean)) %>%
mutate(base_name_clean= gsub("apple macbook pro 2011","apple macbook pro 2012",base_name_clean)) %>%
mutate(base_name_clean= gsub("apple macbook 2015","apple macbook 2017",base_name_clean)) %>%
mutate(base_name_clean= gsub("microsoft surface go","microsoft surface 3",base_name_clean)) %>%
mutate(base_name_clean= gsub("asus rog gl\\d+","asus rog strix ",base_name_clean)) %>%
mutate(base_name_clean= gsub("asus zenbook 3 ","asus zenbook ",base_name_clean)) %>%
mutate(base_name_clean= gsub("dell precision","dell latitude",base_name_clean)) %>%
mutate(base_name_clean= gsub("asus vivobook pro","asus vivobook",base_name_clean)) %>%
mutate(base_name_clean= gsub("razer blade$","razer blade pro",base_name_clean)) %>%
mutate(base_name_clean= gsub("lenovo v330","lenovo chromebook",base_name_clean)) %>%
mutate(base_name_clean= gsub("lenovo 300e","lenovo chromebook",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("dell inspiron chromebook",base_name_clean),"dell chromebook",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus transformer mini",base_name_clean),"asus transformer book mini",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus l402sa",base_name_clean),"  ASUS Vivobook L402SA",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("alienware area-51m",base_name_clean),"alienware 17 r5",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("samsung chromebook xe303c12",base_name_clean),"samsung chromebook",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("acer cb3-532",base_name_clean),"acer chromebook cb3-532",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus c302ca-dhm4",base_name_clean),"asus chromebook c302ca-dhm4",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("acer cb3-531-c4a5",base_name_clean),"acer chromebook cb3-531-c4a5",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("acer r11",base_name_clean),"acer chromebook r11",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("asus c300sa",base_name_clean),"asus chromebook c300sa",base_name_clean)) %>%
mutate(base_name_clean= ifelse(grepl("samsung notebook flash",base_name_clean),"samsung notebook",base_name_clean))
base_nam_test <- base_nam_test %>%
mutate(base_name_clean= gsub("\\s*([(]).*|\\s*([-]).*","",base_nam_test$base_name_clean))
base_nam_test <- base_nam_test %>%
mutate(base_name_clean2= ifelse(grepl("hp",base_name) & grepl("x360",base_name),gsub("x360","flip",base_nam_test$base_name_clean),base_name_clean)) %>%
mutate(base_name_clean = base_name_clean2)
base_nam_test$base_name_clean <- tolower(base_nam_test$base_name_clean)
base_nam_test <- base_nam_test %>%
mutate(base_name_clean=ifelse(grepl("acer",base_name),str_extract(base_nam_test$base_name_clean,"^(?=.*\\bacer\\b)(?:\\S+\\s){2}|^(?=.*\\bacer\\b)(?:\\S+){1}"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("alienware",base_name),str_extract(base_nam_test$base_name_clean,"(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("alienware\\s\\D+\\d+",base_name_clean),str_extract(base_nam_test$base_name_clean,"\\S+\\s\\D+"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus",base_name),str_extract(base_nam_test$base_name_clean,"(\\S+\\s){2,3}|(\\S+\\s\\S+){1,2}"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus x5.*",base_name),"asus x5",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus fx.*",base_name),"asus fx",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("asus\\s[q]\\d+.*",base_name),"asus q",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("dell",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("google",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("hp",base_name_clean) & !grepl("flip",base_name_clean),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("hp",base_name_clean) & grepl("flip",base_name_clean),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){3}|^(\\S+\\s\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("hp\\s\\d+",base_name),"hp",base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("huawei",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("lg",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("microsoft",base_name),str_extract(base_nam_test$base_name_clean,"^(\\w+\\s+){3}|^(\\S+\\s\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("msi",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s+\\D+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("prostar",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s+\\D+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("sager",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s+\\D+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("samsung",base_name),str_extract(base_nam_test$base_name_clean,"^(\\w+\\s+){3}|^(\\S+\\s\\S+\\s\\S+)|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("samsung\\s\\S+\\s\\d+",base_name),str_extract(base_nam_test$base_name_clean,"samsung\\s\\S+"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("razer",base_name),str_extract(base_nam_test$base_name_clean,"^(\\w+\\s+){3}|^(\\S+\\s\\S+\\s\\S+)|^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("jumper",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("toshiba",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("lenovo",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
mutate(base_name_clean=ifelse(grepl("rca",base_name),str_extract(base_nam_test$base_name_clean,"^(\\S+\\s){2}|^(\\S+\\s\\S+)|^(\\S+)"),base_name_clean)) %>%
select(brand,base_name,base_name_clean,name,touchscreen)
base_nam_test <- base_nam_test %>%
mutate(base_name_clean= gsub("flip","",base_name_clean))
base_nam_test$base_name_clean <- str_squish(base_nam_test$base_name_clean)
unique(base_nam_test$base_name_clean)
clean_test3$base_name_clean <- base_nam_test$base_name_clean
clean_test3$base_name_clean[!(clean_test3$base_name_clean %in% clean6$base_name_clean)]
#--------- 2-in-1 laptops - test data --------------------------------------------
clean_test3 <- clean_test3 %>%
mutate(x360 = ifelse(grepl("2-in-1",name)|grepl("x360",name)|grepl("transformer",name)|grepl("convertible",name)|grepl("flip",name)|
grepl("2-in-1",base_name)|grepl("x360",base_name)|grepl("transformer",base_name)|grepl("convertible",base_name)|grepl("flip",base_name)
,1,0))
##------------------weight for Test Data---------------------------------------------------
clean_test3 <- clean_test3 %>%
mutate(weight_clean= ifelse(weight<3,"Up to 3 Pounds",weight)) %>%
mutate(weight_clean= ifelse(weight>=3 & weight<4,"3 to 3.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=4 & weight<5,"4 to 4.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=5 & weight<6,"5 to 5.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=6 & weight<7,"6 to 6.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=7 & weight<8,"7 to 7.9 Pounds",weight_clean)) %>%
mutate(weight_clean= ifelse(weight>=8 ,"8 Pounds & Above",weight_clean))
#--------- Factorising Test Data-----------------------------------------------
clean_test3$screen_size <- as.factor(clean_test3$screen_size)
clean_test3$os <-as.factor(clean_test3$os)
clean_test3$resolution <- as.factor(clean_test3$resolution)
clean_test3$weight_clean <- as.factor(clean_test3$weight_clean)
